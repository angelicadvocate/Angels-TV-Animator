<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Angels-TV-Animator - Admin Dashboard</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../static/assets/ATA_favicon_round.png">
    <link rel="shortcut icon" type="image/png" href="../static/assets/ATA_favicon_round.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../static/css/global.css">
    <link rel="stylesheet" href="../static/css/admin_dashboard.css">
</head>
<body{% if user_theme=='dark' %} class="dark-mode" {% endif %}>
    {% set page_subtitle = "Admin Dashboard" %}
    {% set nav_buttons = [
        {"icon": "fa-folder", "text": "Files", "href": "/admin/manage", "title": "Manage Files"},
        {"icon": "fa-users", "text": "Users", "href": "/admin/users", "title": "Manage Users"}
    ] %}
    {% include 'partials/admin_header.html' %}

    <div class="admin-container">
        {% if show_credentials_warning %}
        <!-- Default Credentials Warning -->
        <div class="security-warning" id="credentialsWarning">
            <div class="warning-content">
                <div class="warning-icon">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                </div>
                <div class="warning-text">
                    <h4>Security Notice</h4>
                    <p>You're logged in with default credentials. For security, we strongly recommend updating your
                        username and password in the <a href="/admin/users">User Management</a> section.</p>
                </div>
                <button class="warning-close" onclick="closeWarning()" title="Dismiss Warning">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
        </div>
        {% endif %}

        <div class="dashboard-grid">
            <!-- Server Status Grid (2x3) -->
            <div class="card">
                <h3><i class="fa-solid fa-chart-simple"></i> Server Status</h3>
                <div class="status-grid-2x3">
                    <div class="status-item">
                        <div class="status-value" id="totalFiles">-</div>
                        <div class="status-label">Total Files</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="connectedClients">-</div>
                        <div class="status-label">Connected Displays</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="animationCount">-</div>
                        <div class="status-label">Animations</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="websocketCount">-</div>
                        <div class="status-label">Connected WebSockets</div>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="videoCount">-</div>
                        <div class="status-label">Videos</div>
                    </div>
                    <div class="status-item">
                        <div class="connection-status">
                            <span class="status-indicator">‚óè</span>
                            <span id="connectionStatus">Connecting...</span>
                        </div>
                        <div class="status-label">Server Connection</div>
                    </div>
                </div>
            </div>

            <!-- Current Media Card -->
            <div class="card">
                <h3><i class="fa-solid fa-play"></i> Current Media</h3>
                <div class="current-media">
                    <div class="media-name" id="currentMediaName">Loading...</div>
                    <div class="media-type" id="currentMediaType">-</div>
                </div>
                <h3><i class="fa-solid fa-wifi"></i> Connected Devices</h3>
                <div class="devices-list">
                    <!-- TV Devices -->
                    <div class="device-section">
                        <div class="device-type-header">
                            <i class="fa-solid fa-tv"></i>
                            <span>TV/Displays</span>
                        </div>
                        <div id="tvDevicesList">
                            <div class="connected-devices">
                                <span class="device-indicator"></span>
                                <span id="tvDeviceStatus">Loading...</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- StreamerBot Connections -->
                    <div class="device-section">
                        <div class="device-type-header">
                            <i class="fa-solid fa-robot"></i>
                            <span>StreamerBot</span>
                        </div>
                        <div id="streamerbotDevicesList">
                            <div class="connected-devices">
                                <span class="device-indicator disconnected" id="streamerbotIndicator"></span>
                                <span id="streamerbotStatus">Not Connected</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- OBS Studio Connections -->
                    <div class="device-section">
                        <div class="device-type-header">
                            <i class="fa-solid fa-video"></i>
                            <span>OBS Studio</span>
                        </div>
                        <div id="obsDevicesList">
                            <div class="connected-devices">
                                <span class="device-indicator disconnected" id="obsIndicator"></span>
                                <span id="obsStatus">Not Connected</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Available Media Card -->
            <div class="card">
                <h3><i class="fa-solid fa-th"></i> Available Media</h3>
                <div class="media-list" id="mediaList">
                    <div style="text-align: center; opacity: 0.6;">Loading media files...</div>
                </div>
            </div>

            <!-- Quick Actions Card -->
            <div class="card quick-actions">
                <h3><i class="fa-solid fa-bolt"></i> Quick Actions</h3>
                <div class="actions-grid">
                    <a href="/admin/manage" class="button"><i class="fa-solid fa-folder"></i> Manage Files</a>
                    <a href="/admin/instructions" class="button secondary"><i class="fa-solid fa-book"></i>
                        Setup/Instructions</a>
                    <button class="button secondary" onclick="openTVView()"><i class="fa-solid fa-tv"></i> Open TV
                        View</button>
                    <a href="/mobile" class="button secondary" target="_blank"><i class="fa-solid fa-mobile-alt"></i> Mobile Control</a>
                    <a href="/admin/obs" class="button secondary"><i class="fa-solid fa-video"></i> Manage OBS Settings</a>
                    <a href="/health" class="button secondary" target="_blank"><i class="fa-solid fa-heartbeat"></i> Health Check</a>
                </div>
            </div>

            <!-- Version Check Banner -->
            <div class="version-banner" id="versionBanner">
                <div class="version-content">
                    <div class="version-icon">
                        <i class="fa-solid fa-circle-check" id="versionIcon"></i>
                    </div>
                    <div class="version-text">
                        <span id="versionMessage">Checking for updates...</span>
                    </div>
                    <button class="version-check-btn" id="versionCheckBtn" onclick="checkForUpdates()" title="Check for Updates">
                        <i class="fa-solid fa-rotate" id="versionCheckIcon"></i> Check for Updates
                    </button>
                </div>
            </div>
        </div>
    </div>

    <button class="refresh-btn" onclick="refreshStatus()" title="Refresh Dashboard">
        <i class="fa-solid fa-rotate-right"></i>
    </button>

    <div class="mascot-corner">
        <img src="../static/assets/mascot.png" alt="Angels-TV-Animator Mascot" class="floating-mascot"
            popovertarget="mascot-message" style="cursor: pointer;" />

        <!-- Popover Easter Egg -->
        <div id="mascot-message" popover="auto" class="mascot-popover">
            <div class="popover-header">
                <span class="popover-title">üéâ Angels-TV-Animator! üéâ</span>
                <button class="popover-close" popovertarget="mascot-message" popovertargetaction="hide">√ó</button>
            </div>
            <div class="popover-content">
                <p>Hey there, explorer! üëã You've discovered my hidden message!</p>
                <p><strong>Thank you</strong> for giving this project a try! Your curiosity and support are what
                    keep it growing. Every person who takes a chance on it helps shape where it goes next, and we
                    appreciate it so much. üíõ</p>
                <p><em>I hope this tool helps you bring your ideas to life and inspires you to keep building,
                    streaming, and creating amazing things!</em></p>
                <p>Have feedback or suggestions? We'd love to hear from you! Submit an issue or pull request on
                    GitHub ‚Äî linked in the top right of this page. If you'd like to support the project, consider
                    giving it a ‚≠ê on GitHub or tipping using the link in the header. Thank you!</p>
            </div>

        </div>
    </div>

    <!-- Footer -->
    <footer class="admin-footer">
        <span>Angels-TV-Animator v{{ app_version }}</span>
    </footer>

    <!-- Include Socket.IO for real-time updates -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="../static/js/global.js"></script>
    <script src="../static/js/admin_dashboard.js"></script>
    </body>

</html>